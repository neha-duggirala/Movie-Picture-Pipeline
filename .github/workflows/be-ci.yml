name: BE-CI

on:
    pull_request:
        branches:
            - main
        paths:
            - 'starter/backend/**'
    workflow_dispatch:

jobs:
    lint:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up Python 3.10
              uses: actions/setup-python@v5
              with:
                python-version: '3.10' 

            - name: Install pipenv
              run: pip install pipenv --user

            - name: Install flake8
              run: pip install flake8

            - name: Install dependencies
              run: cd backend && pipenv install

            - name: Run the linter
              run: cd backend && pipenv run lint

    # test:
    #     runs-on: ubuntu-latest
    #     steps:
    #         - name: Checkout code
    #           uses: actions/checkout@v2

    #         - name: Set up Python
    #           uses: actions/setup-python@v2
    #           with:
    #             python-version: '3.10'

    #         - name: Install dependencies
    #           run: pip install pipenv
              
    #         - name: Install project dependencies
    #           run: pipenv install
              
    #         - name: Run tests
    #           run: pipenv run test
    #         #   working-directory: starter/backend

    # build:
    #     runs-on: ubuntu-latest
    #     needs: [lint, test]
    #     steps:
    #         - name: Checkout code
    #           uses: actions/checkout@v2

    #         - name: Build Docker image
    #           run: docker build -t movie-picture-backend ./starter/backend